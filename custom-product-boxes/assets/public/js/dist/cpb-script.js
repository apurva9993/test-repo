!function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";var a,n=r(1);var c=new((a=n)&&a.__esModule?a:{default:a}).default;c.expandCollapseToggle(),c.hideScrollIndicator(),c.addProductInBox(),c.removeProductFromBox(),c.resetBox(),c.showAccessibilityOnHover(),c.equalHeight(),c.loadPrefilledProducts(),c.ajaxAddToCart()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}();var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cpb_calculations={},this.cpbOnLoad()}return a(t,[{key:"getBundlePrice",value:function(){return this.cpb_calculations.total_bundle_price}},{key:"getBoxTotal",value:function(){return this.cpb_calculations.box_total}},{key:"cpbOnLoad",value:function(){var t=this;t.cpb_calculations.cpbProductData={productId:wdm_bundle_params.cpb_product_id,boxQuantity:parseInt(wdm_bundle_params.box_quantity),isDynamicPricingEnabled:wdm_bundle_params.dynamic_pricing_enable,pricing_type:wdm_bundle_params.pricing_type,productPrice:wdm_bundle_params.product_price,enableProductsSwap:wdm_bundle_params.enableProductsSwap},t.cpb_calculations.box_total=0,t.cpb_calculations.addonsProductData={},t.cpb_calculations.addons_stock={},t.cpb_calculations.cpbProductData.numberOfProductsInBox=0,jQuery(document).ready((function(){t.cpb_calculations.addonsProductData=JSON.parse(jQuery("form.cpb_form").attr("data-addon_list")),t.cpb_calculations.cpbProductData.numberOfProductsInBox=parseInt(jQuery(".cpb-product-box-wrap .cpb-empty-box-inner.filled").length<=0?0:jQuery(".cpb-product-box-wrap .cpb-empty-box-inner.filled").length)})),t.cpb_calculations.total_bundle_price=parseInt(t.cpb_calculations.cpbProductData.productPrice),"cpb-dynamic-nobase"==t.cpb_calculations.cpbProductData.pricing_type&&(t.cpb_calculations.total_bundle_price=0),t.displayBoxTotalPrice(),t.displayBundleTotalPrice()}},{key:"setAddonsData",value:function(t){this.cpb_calculations.addons=this.cpb_calculations.addonsProductData}},{key:"displayBoxTotalPrice",value:function(){var t=this;jQuery(document).ready((function(){jQuery("div.cpb-cart-wrap .cpb-box-total-val div.price").find(".amount").html(wdm_get_price_format(t.getBoxTotal()))}))}},{key:"expandCollapseToggle",value:function(){jQuery(document).on("click",".cpb-show",(function(){jQuery(this).parent().addClass("cpb-expanded"),jQuery(".cpb-product-box-wrap").addClass("cpb-expanded");var t=jQuery(".cpb-product-box-wrap")[0].scrollHeight;jQuery(".cpb-product-box-wrap").css("height",t+"px")})),jQuery(document).on("click",".cpb-hide",(function(){jQuery(this).parent().removeClass("cpb-expanded"),jQuery(".cpb-product-box-wrap").removeClass("cpb-expanded"),jQuery(".cpb-product-box-wrap").css("height","")}))}},{key:"equalHeight",value:function(){jQuery(window).load((function(){setEqualHeight(jQuery(".cpb-products-wrap .cpb-product-info"))})),jQuery(window).resize((function(){setEqualHeight(jQuery(".cpb-products-wrap .cpb-product-info"))}))}},{key:"fillProgressBar",value:function(){var t=jQuery(".cpb-product-box-wrap .cpb-empty-box-inner").length,e=jQuery(".cpb-product-box-wrap .cpb-empty-box-inner.filled").length;jQuery(".cpb-box-count").css("left","calc("+e/t*100+"% - 25px)"),jQuery(".cpb-filled-part").css("width",e/t*100+"%"),jQuery(".cpb-filled-count b").text(e)}},{key:"showAccessibilityOnHover",value:function(){jQuery(document).ready((function(){jQuery(".cpb-product-box-wrap, .cpb-accessibility").hover((function(){jQuery(".cpb-accessibility").css("display","flex")}),(function(){jQuery(".cpb-accessibility").css("display","none")}))}))}},{key:"getAddonStock",value:function(){return this.availableInBox(this.cpb_calculations.addonsProductData,addon_id)?parseInt(this.cpb_calculations.addonsProductData[addon_id].stock_quantity):0}},{key:"availableInBox",value:function(t,e){return!jQuery.isEmptyObject(t)&&isset(t[e])}},{key:"getAddonPrice",value:function(t){return this.availableInBox(this.cpb_calculations.addonsProductData,t)?parseInt(this.cpb_calculations.addonsProductData[t].wc_price):0}},{key:"addQunatity",value:function(t,e){var r=jQuery(t).parents(".cpb-product-inner").attr("data-id");this.format_cpb_addon_quantities(r,e)}},{key:"removeQuantity",value:function(t,e){var r=jQuery(t).parents(".cpb-product-inner").attr("data-id");this.remove_quantity_from_list(r,e)}},{key:"addCount",value:function(t,e){var r=this.getAddedCount(),a=parseInt(jQuery(t).parents(".cpb-product-inner").attr("data-count"));if(r<e){jQuery(t).parents(".cpb-product-inner").attr("data-count",a+1);var n=jQuery(t).parents(".cpb-product-inner").attr("data-count");0==n?jQuery(t).parents(".cpb-product-inner").find(".cpb-count").hide():jQuery(t).parents(".cpb-product-inner").find(".cpb-count").show(),jQuery(t).parents(".cpb-product-inner").find(".cpb-count").text(n),this.addQunatity(t,n)}else{var c=jQuery(".cpb-product-box-wrap").outerHeight();jQuery(".box-full-msg").css("height",c),jQuery(".box-full-msg").css("transform","scale(1)"),jQuery(".box-full-msg")[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),setTimeout((function(){jQuery(".box-full-msg").css("transform","scale(0)")}),2e3)}}},{key:"substractCount",value:function(t){var e=jQuery(t).parents(".cpb-product-inner").attr("data-id"),r=parseInt(jQuery(".cpb-products-wrap .cpb-product-inner[data-id="+e+"]").attr("data-count"));jQuery(".cpb-products-wrap .cpb-product-inner[data-id="+e+"]").attr("data-count",r-1);var a=jQuery(".cpb-products-wrap .cpb-product-inner[data-id="+e+"]").attr("data-count");0==a?jQuery(".cpb-products-wrap .cpb-product-inner[data-id="+e+"]").find(".cpb-count").hide():jQuery(".cpb-products-wrap .cpb-product-inner[data-id="+e+"]").find(".cpb-count").show(),jQuery(".cpb-products-wrap .cpb-product-inner[data-id="+e+"]").find(".cpb-count").text(a),this.removeQuantity(t,a)}},{key:"getAddedCount",value:function(){var t=0;return jQuery(".cpb-products-wrap .cpb-product-inner").each((function(e){t+=parseInt(jQuery(this).attr("data-count"))})),t}},{key:"addProductInBox",value:function(){var t=this;jQuery(document).on("click",".cpb-products-wrap .cpb-img-overlay",(function(){var e=jQuery(".cpb-product-box-wrap .cpb-empty-box-inner").length,r=jQuery(jQuery(".cpb-empty-box-inner").not(".filled")[0]);jQuery(r).addClass("filled").append(jQuery(this).parents(".cpb-product-inner").clone()).find(".cpb-stock-status").remove(),jQuery(r).find(".cpb-img-overlay span img").text("-"),null!=jQuery(r)[0]&&jQuery(r)[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.cpb_calculations.cpbProductData.isDynamicPricingEnabled&&t.addTotalPrice(jQuery(this).parents(".cpb-product-inner").attr("data-id")),t.fillProgressBar(),t.addCount(this,e)}))}},{key:"addTotalPrice",value:function(t){this.addBoxTotal(t),this.addBundleTotal(t),this.displayBundleTotalPrice(t),this.displayBoxTotalPrice(t)}},{key:"addBundleTotal",value:function(t){this.cpb_calculations.total_bundle_price=this.cpb_calculations.total_bundle_price+this.getAddonPrice(t)}},{key:"addBoxTotal",value:function(t){this.cpb_calculations.box_total=this.cpb_calculations.box_total+this.getAddonPrice(t)}},{key:"substractBundleTotal",value:function(t){this.cpb_calculations.total_bundle_price=this.cpb_calculations.total_bundle_price-this.getAddonPrice(t)}},{key:"substractBoxTotal",value:function(t){this.cpb_calculations.box_total=this.cpb_calculations.box_total-this.getAddonPrice(t)}},{key:"substractTotalPrice",value:function(t){this.substractBoxTotal(t),this.substractBundleTotal(t),this.displayBundleTotalPrice(t),this.displayBoxTotalPrice(t)}},{key:"displayBundleTotalPrice",value:function(){var t=wdm_get_price_format(this.getBundlePrice());console.log(t),jQuery(document).ready((function(){jQuery(".cpb-calculated-price").html(t),jQuery("div.cpb-cart-wrap .cpb-grand-total-val div.price").find(".amount").html(t)}))}},{key:"removeProductFromBox",value:function(){var t=this;jQuery(document).on("click",".cpb-product-box-wrap .cpb-img-overlay",(function(){jQuery(this).parents(".wdm-prefill-mandatory").length||(null!=jQuery(this).parents(".cpb-empty-box").prev()[0]&&jQuery(this).parents(".cpb-empty-box").prev()[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),jQuery(this).parents(".cpb-empty-box-inner").removeClass("filled"),jQuery(this).parents(".cpb-product-inner").remove(),t.cpb_calculations.cpbProductData.isDynamicPricingEnabled&&t.substractTotalPrice(jQuery(this).parents(".cpb-product-inner").attr("data-id")),t.fillProgressBar(),t.substractCount(this))}))}},{key:"remove_quantity_from_list",value:function(t,e){var r=this.get_addons_quantities();r.hasOwnProperty(t)&&0==e?delete r[t]:this.format_cpb_addon_quantities(t,e),this.update_qunatity_list(r)}},{key:"get_addons_quantities",value:function(){var t={};return void 0!==jQuery("#addon_quantities_list").val()&&""!=jQuery("#addon_quantities_list").val()&&(t=JSON.parse(jQuery("#addon_quantities_list").val())),t}},{key:"format_cpb_addon_quantities",value:function(t,e){var r=this.get_addons_quantities();r[t.toString()]=e,this.update_qunatity_list(r)}},{key:"update_qunatity_list",value:function(t){get_length(t)>0&&jQuery("#addon_quantities_list").val(JSON.stringify(t)),0==get_length(t)&&jQuery("#addon_quantities_list").val("")}},{key:"hideScrollIndicator",value:function(){jQuery(document).ready((function(){jQuery(".cpb-product-box-wrap, .cpb-products-wrap").scroll((function(){jQuery(".scroll-indicator").hide()}))}))}},{key:"addNoStockClass",value:function(t){}},{key:"resetBox",value:function(){var t=this;jQuery(document).on("click",".cpb-refresh",(function(){jQuery(".cpb-empty-box .filled .cpb-product-inner").remove(),jQuery(".cpb-empty-box-inner").removeClass("filled"),t.fillProgressBar(),jQuery(".cpb-count").hide(),jQuery(".cpb-product-inner").attr("data-count","0")}))}},{key:"loadPrefilledProducts",value:function(){var t=this;jQuery(document).ready((function(){var e=jQuery(".cpb-product-box-wrap .cpb-empty-box-inner").length;jQuery(".cpb-product-box-wrap .cpb-product-inner.wdm-prefill-product").each((function(r,a){var n=jQuery(a).attr("data-id"),c=jQuery("#cpb-product-"+n).find(".cpb-img-overlay");t.addCount(c,e)})),t.fillProgressBar()}))}},{key:"ajaxAddToCart",value:function(){jQuery(document).on("click",".single_add_to_cart_button",(function(t){var e=jQuery("body").attr("class").match(/\d+/);if(e=e[0],jQuery("#product-"+e).hasClass("product-type-wdm_bundle_product")){t.preventDefault();var r=jQuery(this),a=r.closest("form.cart"),n=r.val(),c=a.find("input[name=quantity]").val()||1,o=a.find("input[name=product_id]").val()||n,u=a.find("input[name=addon_quantities_list]").val()||{},i={action:"woocommerce_ajax_add_to_cart",cpb_product_id:o,product_sku:"",cpb_product_qty:c,cpb_addon_ids:u=u};return r.removeClass("added"),jQuery(document.body).trigger("adding_to_cart",[r,i]),jQuery.ajax({type:"post",url:wc_add_to_cart_params.ajax_url,data:i,beforeSend:function(t){remove_previous_notices(),r.removeClass("added").addClass("loading"),r.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},complete:function(t){r.addClass("added").removeClass("loading"),r.unblock()},success:function(t){if(t.error&&t.error_msg)return add_error_notice(t.error_msg,"cpb_error"),void jQuery("html, body").animate({scrollTop:0},"slow");t.error&&t.product_url?window.location=t.product_url:(jQuery(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,r]),r.unblock())}}),!1}}))}}]),t}();e.default=n}]);